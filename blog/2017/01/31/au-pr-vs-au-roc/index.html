<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>healthcare.ai</title>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-85609357-1', 'auto');
  ga('send', 'pageview');
</script>

<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '747112772022739');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=747112772022739&ev=PageView&noscript=1"/>
</noscript>
<!-- DO NOT MODIFY -->
<!-- End Facebook Pixel Code -->

    

    <base href="http://healthcare.ai/" />

    <!-- Bootstrap Core CSS -->
    <link href="splashvendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Theme CSS -->
    <link href="splashcss/clean-blog.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.splashjs/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body>
<!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    Menu <i class="fa fa-bars"></i>
                </button>
                <div class="navbar-brand"><img src="./splashimg/healthcareAI.svg" width="207" height="30" alt="healthcare.ai logo"/></div>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#about">About</a>
                    </li>
                    <li>
                        <a href="./blog">Blog</a>
                    </li>
                    <li>
                        <a href="./contact.html">Contact</a>
                    </li>
                    <li>
                        <a href="#why">Why Open Source</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header" style="background-image: url('splashimg/home-bg.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="site-heading">
                        <h1>healthcare.ai is open source software<br>streamlining healthcare machine learning</h1>
                        <span class="subheading">
                        	<a href="./r">
                            <button type="button" class="btn btn-default"><img src="./splashimg/rLang.png" width="70" height="45" alt="R Language Icon"/>R Package</button></a>
                            <a href="./py">
							<button type="button" class="btn btn-default"><img src="./splashimg/python.png" width="70" height="45" alt="Python Language Icon"/>Python Package</button></a>
                        </span>
                        <h2><a href=https://pages.healthcatalyst.com/2017-02-08HealthcareaiWebinarWebsite.html>Register</a> for our Feb 8th webinar on getting started with healthcare.ai!</h2>
                    </div>
                </div>
            </div>
        </div>
    </header>
<div class="content">
    <div class="container">
        <div class="row-fluid">
                <h1 class="entry-title"><a href="">How can precision-recall curves help evaluate your model?</a></h1>
                January 31, 2017
                <p>Whenever we use machine learning (ML) for prediction, the question of how to evaluate the model is of the utmost importance. Of course, different metrics are appropriate for different kinds of models and business questions. If we were to predict patient length of stay (LOS)—a numeric value—we’d use a different model evaluation metric than if we were evaluating a model that predicts 30-day readmissions, which is a binary column (i.e., Y or N). It’s these types of decisions that <a href="http://healthcare.ai/">healthcare.ai</a> streamlines.</p>

<p>In healthcare, we’re most commonly focused binary predictions—think of readmissions, hospital-acquired infections, mortality, appointment no-shows, etc. In addition, our data frequently has <em>imbalanced classes</em>. What this means is that, for the column we’re predicting (i.e., no-shows, readmissions, etc.), there are many more of either Y’s or N’s. In healthcare ML, it’s typically the case that N is much more common than Y. That’s a good thing. It’s nice that most people don’t get a hospital-acquired infection. However, because of this label imbalance, the most common classification evaluation metric could benefit from some adjustments.</p>

<p>For binary classification, the gold-standard for evaluation is the ROC curve and the associated area under the curve (AUC). <a href="http://healthcare.ai/blog/2016/12/15/model-evaluation-using-roc-curves/">In a past post</a>, we’ve detailed why these are common. Considering that imbalanced classes are so pervasive in healthcare, we’re excited to detail why we’ve also included precision-recall (PR) curves and the associated area under the curve in the R 0.1.10 release of healthcare.ai. In the following discussion, we’ll focus on the curves themselves, but the same thoughts apply to both AU_ROC and AU_PR, which is area under the ROC and PR curves, respectively.</p>

<p>Recall that the <a href="http://healthcare.ai/blog/2016/12/15/model-evaluation-using-roc-curves/">ROC</a> shows the <em>True Positive Rate (TPR)</em> on the y-axis and the <em>False Positive Rate (FPR)</em> on the X-axis. As that <a href="http://healthcare.ai/blog/2016/12/15/model-evaluation-using-roc-curves/">previous post</a> explained, <em>TPR</em> is the proportion of actual readmissions that the test correctly predicted would be readmitted. <em>FPR</em> is the proportion of patients whom the model predicted would be readmitted, but were not. Here’s a ROC curve, for reference.</p>

<p><img src="../assets/AUCPost_ROCExample.png" alt="Example ROC Curves" /></p>

<p>TPR is also known as <a href="https://en.wikipedia.org/wiki/Precision_and_recall#Definition_.28classification_context.29"><em>recall</em></a> and also is present in PR curves. Compared to a ROC curve, a PR curve simple moves TPR (i.e., recall) to the x-axis and swaps out FPR for precision (which is on the y-axis). Now, why is that so significant when it comes to data with imbalanced classes? Consider the true negative. When you have data with a 10% rate of 30-day readmissions and that’s what you’re predicting, your model could simply predict N 90% of the time and be correct. Introducing precision instead of FPR in the PR curve is helpful because, as <a href="http://machinelearning.wustl.edu/mlpapers/paper_files/icml2006_DavisG06.pdf">this paper</a> states, “a large change in the number of false positives can lead to a small change in the false positive rate.” Basically, with highly-imbalanced classes FPR is overwhelmed by the number of true negatives. Precision, on the other hand, focuses on true positives and false positives (which are much more relevant than true negatives when your classes are imbalanced toward negatives). We’ve created a guide that was inspired by this Stack Overflow <a href="http://stats.stackexchange.com/a/90783/124897">answer</a>:</p>

<p><img src="../assets/Post17PRcurve/Equations_final.jpg" alt="Equations" /></p>

<p>Note the lack of TNs in the second set of equations. Now, <em>how do the two metrics compare on the same dataset?</em> Let’s use the <a href="https://github.com/HealthCatalystSLC/healthcareai-r/blob/master/inst/extdata/HCRDiabetesClinical.csv">diabetes dataset</a> that comes with healthcare.ai to compare Lasso vs. Random Forest when predicting readmissions:</p>

<p><img src="../assets/Post17PRcurve/ROCExample.png" alt="ROCExample" /></p>

<p><img src="../assets/Post17PRcurve/PRCurveExample.png" alt="PRExample" /></p>

<p>Note that the Random Forest-based model performs better than the Lasso-based model—note the greater area under the curve. However, we find that the difference between the algorithms is much more stark in terms of the ROC curve compared with the PR curve. Is this typically the case?</p>

<p>As we read in <a href="http://machinelearning.wustl.edu/mlpapers/paper_files/icml2006_DavisG06.pdf">this paper</a>, “an algorithm that optimizes the area under the ROC curve is not guaranteed to optimize the area under the PR curve.” If you have highly imbalanced classes, you may want to focus on the PR curve and maximizing the area under the curve (i.e., AU_PR), even though common benchmarks and your related presentation may tout your awesome results in terms of ROC. Happy modeling!</p>

<p>Feel free to <a href="http://healthcare.ai/contact.html">reach out with questions</a>, and thanks for reading.</p>


                
                <p>Subscribe to email updates: <a href="https://feedburner.google.com/fb/a/mailverify?uri=healthcareai&amp;loc=en_US"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
                <a href="https://feedburner.google.com/fb/a/mailverify?uri=healthcareai&amp;loc=en_US" onclick="window.open(this.href, 'mywin','left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" >
                <i class="fa-rss fa"></i></a></a></p>           
        </div>
    </div>
</div>
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <p class="copyright">This project was started by and receives ongoing support from &nbsp;<a href="http://healthcatalyst.com"><img src="splashimg/healthCatalystWhite.png" width="142" height="37" alt="Health Catalyst Logo"/></a></p>
                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="splashvendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="splashvendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="splashjs/jqBootstrapValidation.js"></script>
    <script src="splashjs/contact_me.js"></script>

    <!-- Theme JavaScript -->
    <script src="splashjs/clean-blog.min.js"></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-85609357-1', 'auto');
  ga('send', 'pageview');
</script>

<!-- Facebook Pixel Code -->
<script>
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '747112772022739');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=747112772022739&ev=PageView&noscript=1"/>
</noscript>
<!-- DO NOT MODIFY -->
<!-- End Facebook Pixel Code -->

</body>

</html>